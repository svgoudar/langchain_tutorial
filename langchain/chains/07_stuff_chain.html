

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Stuff Chain &#8212; Machine Learning Handbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-examples.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/js/hoverxref.js"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'langchain/chains/07_stuff_chain';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="TransformChain (LangChain)" href="08_transform_chain.html" />
    <link rel="prev" title="Refine Chain" href="06_refine_chain.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Machine Learning Handbook - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Machine Learning Handbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    LangChain Tutorial
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../core/overview.html">LangChain Core</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../core/01_llms.html">LLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/02_chat_models.html">Chat Model</a></li>


<li class="toctree-l2"><a class="reference internal" href="../core/03_model_providers.html">Model Provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/04_prompt_templates.html">Prompt Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/05_output_parsers.html">Output Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/06_runnable_interface.html">Runnable Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core/07_lcel.html">LangChain Expression Language (LCEL)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../core/08_model_parameters.html">Model Parameters</a></li>



</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../prompt_engineering/overview.html">Prompt Engineering</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/01_prompt_template.html">PromptTemplate (LangChain)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/02_chat_prompt_template.html">ChatPromptTemplate (LangChain)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/03_system_human_ai_messages.html">System / Human / AI Messages (LangChain)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/04_few_shot_prompting.html">Few-shot Prompting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/05_chain_of_thought.html">Chain-of-Thought (CoT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/06_self_consistency.html">Self-Consistency (LangChain Perspective)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/07_instruction_prompting.html">Instruction Tuning (LangChain &amp; LLM Perspective)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/08_structured_output_prompts.html">Structured Output Prompts (LangChain Perspective)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prompt_engineering/09_guardrails.html">Guardrails (LangChain Perspective)</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="overview.html">LangChain Chains</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_llmchain.html">LLMChain</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_sequential_chain.html">SequentialChain (LangChain)</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_simple_sequential_chain.html">SimpleSequentialChain (LangChain)</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_router_chain.html">Router Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_map_reduce_chains.html">MapReduce Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_refine_chain.html">Refine Chain</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Stuff Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="08_transform_chain.html">TransformChain (LangChain)</a></li>
<li class="toctree-l2"><a class="reference internal" href="09_retrievalqa_chain.html">RetrievalQA Chain (LangChain)</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_conversational_retrieval_chain.html">ConversationalRetrievalChain</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../rag/overview.html">Retrieval-Augmented Generation (RAG)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../rag/01_document_loaders.html">Document Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/02_text_splitters.html">Text Splitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/03_chunk_overlap.html">Chunk Overlap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/04_embeddings.html">Embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/05_vector_stores.html">Vector Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/06_similarity_search.html">Similarity Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/07_mmr.html">Maximal Marginal Relevance (MMR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/08_hybrid_search.html">Hybrid Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/09_reranking.html">Reranking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/10_context_window_management.html">Context Window Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/11_source_attribution.html">Source Attribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/12_hallucination_prevention.html">Hallucination Prevention and Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rag/13_types_of_rag.html">Types of RAG (Retrieval-Augmented Generation)</a></li>














</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../agents/overview.html">LangChain Agents</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../agents/01_tool_calling.html">Tool Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/02_react_agents.html">ReAct Agent (Reason + Act)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/03_openai_tools_agent.html">OpenAI Tools Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/04_conversational_agents.html">Conversational Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/05_multi_tool_agents.html">Multi-Tool Agents</a></li>
















<li class="toctree-l2"><a class="reference internal" href="../agents/06_function_calling.html">Function Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/07_agent_scratchpad.html">agent_scratchpad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/08_agent_executor.html">AgentExecutor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/09_agent_memory.html">Agent Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/10_planning_vs_execution_agents.html">Planning vs Execution Agents</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tools/overview.html">Tools</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tools/01_custom_tools.html">Custom Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/02_structured_tools.html">Structured Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/03_tool_schemas.html">Tool Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/04_api_tools.html">API Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/05_database_tools.html">Database Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/06_file_system_tools.html">File System Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/07_web_search_tools.html">Web Search Tools — Explanation with Demonstration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools/08_mcp_tool_adapters.html">MCP Tool Adapters</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../memory/overview.html">Memory Systems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../memory/01_conversation_buffer_memory.html">ConversationBufferMemory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/02_conversation_summary_memory.html">ConversationSummaryMemory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/03_conversation_buffer_window_memory.html">ConversationBufferWindowMemory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/04_vectorstore_backed_memory.html">VectorStore-Backed Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/05_entity_memory.html">Entity Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/06_session_based_memory.html">Session-Based Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/07_long_term_vs_short_term_memory.html">Long-Term vs Short-Term Memory</a></li>



</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lcel/overview.html">LangChain Expression Language (LCEL)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lcel/01_runnable_passthrough.html">RunnablePassthrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lcel/02_runnable_lambda.html">RunnableLambda</a></li>

<li class="toctree-l2"><a class="reference internal" href="../lcel/03_runnable_parallel.html">RunnableParallel</a></li>

<li class="toctree-l2"><a class="reference internal" href="../lcel/04_runnable_sequence.html">RunnableSequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lcel/05_streaming_runnables.html">Streaming Runnables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lcel/06_batch_execution.html">Batch Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lcel/07_async_execution.html">Async Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lcel/08_retry_and_fallbacks.html">Retry and Fallback</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../streaming_callbacks/overview.html">Streaming and Callbacks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../streaming_callbacks/01_token_streaming.html">Token Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streaming_callbacks/02_callback_handlers.html">Callback Handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streaming_callbacks/03_tracing.html">Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streaming_callbacks/04_logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streaming_callbacks/05_observability_hooks.html">Observability Hooks</a></li>



<li class="toctree-l2"><a class="reference internal" href="../streaming_callbacks/06_cost_tracking.html">Cost Tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../streaming_callbacks/07_latency_tracking.html">Latency Tracking</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../evaluation/overview.html">Evaluation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/01_llm_evaluation.html">LLM Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/02_rag_evaluation.html">RAG Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/03_faithfulness.html">Faithfulness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/04_relevance.html">Relevance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/05_answer_correctness.html">Answer Correctness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/06_synthetic_data_generation.html">Synthetic Data Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/07_regression_testing.html">Regression Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/08_prompt_versioning.html">Regression Testing</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../data_ingestion/overview.html">Data Ingestion</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../data_ingestion/01_pdf_csv_html_loaders.html">Document Loaders — PDF / CSV / HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_ingestion/02_web_scraping.html">Web Scraping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_ingestion/03_api_based_loaders.html">API-Based Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_ingestion/04_data_cleaning.html">Data Cleaning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_ingestion/05_metadata_enrichment.html">Metadata Enrichment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_ingestion/06_document_versioning.html">Document Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_ingestion/07_incremental_ingestion.html">Incremental Ingestion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_ingestion/08_cdc_style_updates.html">CDC (Change Data Capture) Style Updates</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../caching/overview.html">LangChain Caching</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../caching/01_prompt_caching.html">Prompt Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching/02_llm_response_caching.html">LLM Response Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching/03_embedding_caching.html">Embeddings Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching/04_redis_cache.html">Redis Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching/05_in_memory_cache.html">In-Memory Cache — Explanation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching/06_cache_invalidation.html">Cache Invalidation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching/07_rate_limiting.html">Rate Limiting</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../security/overview.html">Security</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../security/01_prompt_injection_detection.html">Prompt Injection Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/02_input_sanitization.html">Input Sanitization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/03_output_validation.html">Output Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/04_content_filtering.html">Content Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/05_secrets_management.html">Secrets Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/06_role_based_access.html">Role-Based Access Control (RBAC)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../deployment/overview.html">Deployment</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../deployment/01_fastapi_integration.html">FastAPI Integration with LangChain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/02_gradio_streamlit_ui.html">Gradio and Streamlit UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/03_background_tasks.html">Background Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/04_async_workers.html">Async Workers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/05_server_sent_events.html">Server-Sent Events (SSE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/06_websockets.html">WebSockets —</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/07_load_balancing.html">Load Balancing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/08_horizontal_scaling.html">Horizontal Scaling</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../interoperability/overview.html">Interoperability</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../interoperability/01_langgraph_integration.html">LangGraph Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interoperability/02_llamaindex_integration.html">LlamaIndex Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interoperability/03_mcp_integration.html">MCP (Model Context Protocol) Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interoperability/04_external_vector_dbs.html">External Vector Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interoperability/05_cloud_services.html">Cloud Services</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../production/overview.html">Production Best Practices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../production/01_config_management.html">Configuration Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production/02_environment_separation.html">Environment Separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production/03_cicd_for_prompts.html">Environment Separation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production/04_versioned_pipelines.html">Versioned Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production/05_rollbacks.html">Rollbacks in LLM Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production/06_monitoring_and_alerts.html">Monitoring and Alerts — Detailed Explanation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../production/07_cost_optimization.html">Cost Optimization — Detailed Explanation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../metrics/overview.html">Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../metrics/01_intrinsic_metrics.html">Intrinsic (Model-Centric) Metrics</a></li>

















<li class="toctree-l2"><a class="reference internal" href="../metrics/02_task_metrics.html">Task &amp; Quality Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/03_RAG_metrics.html">RAG and Knowledge Grounding Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/04_safety_metrics.html">Safety &amp; Alignment Metrics</a></li>

<li class="toctree-l2"><a class="reference internal" href="../metrics/05_perf_metrics.html">Performance Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/06_cost_effeciency_metrics.html">Cost &amp; Efficiency Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/07_reliability_stability_metrics.html">Reliability &amp; Stability Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/08_user_experience_metrics.html">User Experience Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../advanced/overview.html">Advanced LangChain Patterns</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/01_agentic_rag.html">Agentic RAG — Detailed Explanation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/02_context_aware_rag.html">Context-Aware RAG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/03_hierarchical_agents.html">Hierarchical Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/04_self_reflection.html">Self-Reflection in LLM Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/05_tool_reranking.html">Tool Re-Ranking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/06_online_learning_from_feedback.html">Online Learning from Feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/07_multi_modal_chains.html">Multi-Modal Chain — Brief Explanation</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/svgoudar/Learn-ML-and-NLP/blob/master/langchain/chains/07_stuff_chain.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/svgoudar/Learn-ML-and-NLP" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/svgoudar/Learn-ML-and-NLP/issues/new?title=Issue%20on%20page%20%2Flangchain/chains/07_stuff_chain.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/langchain/chains/07_stuff_chain.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Stuff Chain</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-stuff-chain-exists">Why Stuff Chain Exists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-flow">Conceptual Flow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-stuff-chain-works-internally">How Stuff Chain Works Internally</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-stuff-chain-demonstration">Basic Stuff Chain Demonstration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-define-the-prompt">Step 1: Define the Prompt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-create-the-stuff-chain">Step 2: Create the Stuff Chain</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-invoke-the-chain">Step 3: Invoke the Chain</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-execution-simplified">Internal Execution (Simplified)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-use-cases">Common Use Cases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-vs-mapreduce">Stuff Chain vs MapReduce</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-vs-refine">Stuff Chain vs Refine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-of-stuff-chain">Limitations of Stuff Chain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-in-rag-pipelines">Stuff Chain in RAG Pipelines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-vs-lcel-modern-approach">Stuff Chain vs LCEL (Modern Approach)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-legacy">Stuff Chain (Legacy)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lcel-equivalent-conceptual">LCEL Equivalent (Conceptual)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-stuff-chain">When to Use Stuff Chain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-not-to-use-stuff-chain">When NOT to Use Stuff Chain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-practices">Best Practices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interview-ready-summary">Interview-Ready Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rule-of-thumb">Rule of Thumb</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#stuff-chain" id="id1">Stuff Chain</a></p>
<ul>
<li><p><a class="reference internal" href="#why-stuff-chain-exists" id="id2">Why Stuff Chain Exists</a></p></li>
<li><p><a class="reference internal" href="#conceptual-flow" id="id3">Conceptual Flow</a></p></li>
<li><p><a class="reference internal" href="#how-stuff-chain-works-internally" id="id4">How Stuff Chain Works Internally</a></p></li>
<li><p><a class="reference internal" href="#basic-stuff-chain-demonstration" id="id5">Basic Stuff Chain Demonstration</a></p>
<ul>
<li><p><a class="reference internal" href="#step-1-define-the-prompt" id="id6">Step 1: Define the Prompt</a></p></li>
<li><p><a class="reference internal" href="#step-2-create-the-stuff-chain" id="id7">Step 2: Create the Stuff Chain</a></p></li>
<li><p><a class="reference internal" href="#step-3-invoke-the-chain" id="id8">Step 3: Invoke the Chain</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#internal-execution-simplified" id="id9">Internal Execution (Simplified)</a></p></li>
<li><p><a class="reference internal" href="#common-use-cases" id="id10">Common Use Cases</a></p></li>
<li><p><a class="reference internal" href="#stuff-chain-vs-mapreduce" id="id11">Stuff Chain vs MapReduce</a></p></li>
<li><p><a class="reference internal" href="#stuff-chain-vs-refine" id="id12">Stuff Chain vs Refine</a></p></li>
<li><p><a class="reference internal" href="#limitations-of-stuff-chain" id="id13">Limitations of Stuff Chain</a></p></li>
<li><p><a class="reference internal" href="#stuff-chain-in-rag-pipelines" id="id14">Stuff Chain in RAG Pipelines</a></p></li>
<li><p><a class="reference internal" href="#stuff-chain-vs-lcel-modern-approach" id="id15">Stuff Chain vs LCEL (Modern Approach)</a></p>
<ul>
<li><p><a class="reference internal" href="#stuff-chain-legacy" id="id16">Stuff Chain (Legacy)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#lcel-equivalent-conceptual" id="id17">LCEL Equivalent (Conceptual)</a></p></li>
<li><p><a class="reference internal" href="#when-to-use-stuff-chain" id="id18">When to Use Stuff Chain</a></p></li>
<li><p><a class="reference internal" href="#when-not-to-use-stuff-chain" id="id19">When NOT to Use Stuff Chain</a></p></li>
<li><p><a class="reference internal" href="#best-practices" id="id20">Best Practices</a></p></li>
<li><p><a class="reference internal" href="#interview-ready-summary" id="id21">Interview-Ready Summary</a></p></li>
<li><p><a class="reference internal" href="#rule-of-thumb" id="id22">Rule of Thumb</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="stuff-chain">
<h1><a class="toc-backref" href="#id1">Stuff Chain</a><a class="headerlink" href="#stuff-chain" title="Permalink to this heading">#</a></h1>
<p>A <strong>Stuff Chain</strong> is a LangChain abstraction that <strong>“stuffs” all input documents or text chunks into a single prompt</strong> and sends them to the LLM <strong>in one call</strong>.</p>
<blockquote>
<div><p>There is <strong>no splitting, no iteration, no aggregation</strong> — everything is passed at once.</p>
</div></blockquote>
<p>It is the <strong>simplest</strong> document-processing chain in LangChain.</p>
<hr class="docutils" />
<section id="why-stuff-chain-exists">
<h2><a class="toc-backref" href="#id2">Why Stuff Chain Exists</a><a class="headerlink" href="#why-stuff-chain-exists" title="Permalink to this heading">#</a></h2>
<p>Stuff chain exists for:</p>
<ul class="simple">
<li><p>Small inputs</p></li>
<li><p>Quick summarization</p></li>
<li><p>Simple RAG demos</p></li>
<li><p>Lowest latency workflows</p></li>
</ul>
<p>It assumes:</p>
<ul class="simple">
<li><p>The entire input <strong>fits within the model’s context window</strong></p></li>
<li><p>The model can reason over all content at once</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="conceptual-flow">
<h2><a class="toc-backref" href="#id3">Conceptual Flow</a><a class="headerlink" href="#conceptual-flow" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>All Documents
   ↓
Concatenate (stuff)
   ↓
Single Prompt
   ↓
LLM
   ↓
Final Output
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="how-stuff-chain-works-internally">
<h2><a class="toc-backref" href="#id4">How Stuff Chain Works Internally</a><a class="headerlink" href="#how-stuff-chain-works-internally" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Take all documents</p></li>
<li><p>Concatenate their contents</p></li>
<li><p>Inject into a single prompt variable</p></li>
<li><p>Call the LLM once</p></li>
</ol>
<p>No intermediate steps are stored.</p>
</section>
<hr class="docutils" />
<section id="basic-stuff-chain-demonstration">
<h2><a class="toc-backref" href="#id5">Basic Stuff Chain Demonstration</a><a class="headerlink" href="#basic-stuff-chain-demonstration" title="Permalink to this heading">#</a></h2>
<section id="step-1-define-the-prompt">
<h3><a class="toc-backref" href="#id6">Step 1: Define the Prompt</a><a class="headerlink" href="#step-1-define-the-prompt" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">langchain_core.prompts</span><span class="w"> </span><span class="kn">import</span> <span class="n">PromptTemplate</span>

<span class="n">prompt</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span>
    <span class="s2">&quot;Answer the question using the following context:</span><span class="se">\n</span><span class="si">{context}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="step-2-create-the-stuff-chain">
<h3><a class="toc-backref" href="#id7">Step 2: Create the Stuff Chain</a><a class="headerlink" href="#step-2-create-the-stuff-chain" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">langchain_classic.chains.summarize</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_summarize_chain</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">langchain_openai</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatOpenAI</span>

<span class="n">llm</span> <span class="o">=</span> <span class="n">ChatOpenAI</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4o-mini&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">chain</span> <span class="o">=</span> <span class="n">load_summarize_chain</span><span class="p">(</span>
    <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
    <span class="n">chain_type</span><span class="o">=</span><span class="s2">&quot;stuff&quot;</span><span class="p">,</span>
    <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="step-3-invoke-the-chain">
<h3><a class="toc-backref" href="#id8">Step 3: Invoke the Chain</a><a class="headerlink" href="#step-3-invoke-the-chain" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">langchain_core.documents</span><span class="w"> </span><span class="kn">import</span> <span class="n">Document</span>

<span class="c1"># Create sample documents</span>
<span class="n">documents</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Document</span><span class="p">(</span><span class="n">page_content</span><span class="o">=</span><span class="s2">&quot;Artificial Intelligence is transforming industries worldwide. Machine learning algorithms enable computers to learn from data and improve their performance over time without explicit programming.&quot;</span><span class="p">),</span>
    <span class="n">Document</span><span class="p">(</span><span class="n">page_content</span><span class="o">=</span><span class="s2">&quot;Natural Language Processing allows machines to understand and generate human language. Applications include chatbots, translation services, and sentiment analysis.&quot;</span><span class="p">),</span>
    <span class="n">Document</span><span class="p">(</span><span class="n">page_content</span><span class="o">=</span><span class="s2">&quot;Computer vision enables machines to interpret and understand visual information from the world. It powers technologies like facial recognition, autonomous vehicles, and medical image analysis.&quot;</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">invoke</span><span class="p">({</span><span class="s2">&quot;input_documents&quot;</span><span class="p">:</span> <span class="n">documents</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;output_text&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>What are some applications of Artificial Intelligence mentioned in the context?

Some applications of Artificial Intelligence mentioned include chatbots, translation services, sentiment analysis, facial recognition, autonomous vehicles, and medical image analysis.
</pre></div>
</div>
</div>
</div>
<p>All documents are stuffed into <code class="docutils literal notranslate"><span class="pre">{context}</span></code>.</p>
</section>
</section>
<hr class="docutils" />
<section id="internal-execution-simplified">
<h2><a class="toc-backref" href="#id9">Internal Execution (Simplified)</a><a class="headerlink" href="#internal-execution-simplified" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">context</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">doc1</span><span class="p">,</span> <span class="n">doc2</span><span class="p">,</span> <span class="n">doc3</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">LLM</span><span class="p">(</span><span class="n">prompt</span><span class="p">(</span><span class="n">context</span><span class="p">))</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="common-use-cases">
<h2><a class="toc-backref" href="#id10">Common Use Cases</a><a class="headerlink" href="#common-use-cases" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Small document summarization</p></li>
<li><p>FAQ answering</p></li>
<li><p>Short reports</p></li>
<li><p>RAG with few chunks</p></li>
<li><p>Prototyping and demos</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="stuff-chain-vs-mapreduce">
<h2><a class="toc-backref" href="#id11">Stuff Chain vs MapReduce</a><a class="headerlink" href="#stuff-chain-vs-mapreduce" title="Permalink to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Aspect</p></th>
<th class="head"><p>Stuff Chain</p></th>
<th class="head"><p>MapReduce</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Scalability</p></td>
<td><p>Low</p></td>
<td><p>High</p></td>
</tr>
<tr class="row-odd"><td><p>Latency</p></td>
<td><p>Low</p></td>
<td><p>Medium</p></td>
</tr>
<tr class="row-even"><td><p>Parallelism</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p>Context usage</p></td>
<td><p>High</p></td>
<td><p>Controlled</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="stuff-chain-vs-refine">
<h2><a class="toc-backref" href="#id12">Stuff Chain vs Refine</a><a class="headerlink" href="#stuff-chain-vs-refine" title="Permalink to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Aspect</p></th>
<th class="head"><p>Stuff</p></th>
<th class="head"><p>Refine</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Order sensitivity</p></td>
<td><p>Low</p></td>
<td><p>High</p></td>
</tr>
<tr class="row-odd"><td><p>Accuracy on long docs</p></td>
<td><p>Low</p></td>
<td><p>High</p></td>
</tr>
<tr class="row-even"><td><p>Latency</p></td>
<td><p>Low</p></td>
<td><p>High</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<hr class="docutils" />
<section id="limitations-of-stuff-chain">
<h2><a class="toc-backref" href="#id13">Limitations of Stuff Chain</a><a class="headerlink" href="#limitations-of-stuff-chain" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>❌ Breaks if input exceeds context window</p></li>
<li><p>❌ Expensive for large documents</p></li>
<li><p>❌ No partial fault tolerance</p></li>
<li><p>❌ Legacy abstraction</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="stuff-chain-in-rag-pipelines">
<h2><a class="toc-backref" href="#id14">Stuff Chain in RAG Pipelines</a><a class="headerlink" href="#stuff-chain-in-rag-pipelines" title="Permalink to this heading">#</a></h2>
<p>Stuff chain is commonly used when:</p>
<ul class="simple">
<li><p>Retriever returns <strong>few, small chunks</strong></p></li>
<li><p>You want a <strong>single grounded answer</strong></p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Retriever → Stuff Chain → Answer
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="stuff-chain-vs-lcel-modern-approach">
<h2><a class="toc-backref" href="#id15">Stuff Chain vs LCEL (Modern Approach)</a><a class="headerlink" href="#stuff-chain-vs-lcel-modern-approach" title="Permalink to this heading">#</a></h2>
<section id="stuff-chain-legacy">
<h3><a class="toc-backref" href="#id16">Stuff Chain (Legacy)</a><a class="headerlink" href="#stuff-chain-legacy" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">langchain_classic.chains.summarize</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_summarize_chain</span>
<span class="n">load_summarize_chain</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span> <span class="n">chain_type</span><span class="o">=</span><span class="s2">&quot;stuff&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>StuffDocumentsChain(verbose=False, llm_chain=LLMChain(verbose=False, prompt=PromptTemplate(input_variables=[&#39;text&#39;], input_types={}, partial_variables={}, template=&#39;Write a concise summary of the following:\n\n\n&quot;{text}&quot;\n\n\nCONCISE SUMMARY:&#39;), llm=ChatOpenAI(profile={&#39;max_input_tokens&#39;: 128000, &#39;max_output_tokens&#39;: 16384, &#39;image_inputs&#39;: True, &#39;audio_inputs&#39;: False, &#39;video_inputs&#39;: False, &#39;image_outputs&#39;: False, &#39;audio_outputs&#39;: False, &#39;video_outputs&#39;: False, &#39;reasoning_output&#39;: False, &#39;tool_calling&#39;: True, &#39;structured_output&#39;: True, &#39;image_url_inputs&#39;: True, &#39;pdf_inputs&#39;: True, &#39;pdf_tool_message&#39;: True, &#39;image_tool_message&#39;: True, &#39;tool_choice&#39;: True}, client=&lt;openai.resources.chat.completions.completions.Completions object at 0x0000018D9025D7F0&gt;, async_client=&lt;openai.resources.chat.completions.completions.AsyncCompletions object at 0x0000018D9025C650&gt;, root_client=&lt;openai.OpenAI object at 0x0000018D9025D550&gt;, root_async_client=&lt;openai.AsyncOpenAI object at 0x0000018D9025D460&gt;, model_name=&#39;gpt-4o-mini&#39;, temperature=0.0, model_kwargs={}, openai_api_key=SecretStr(&#39;**********&#39;), stream_usage=True), output_parser=StrOutputParser(), llm_kwargs={}), document_prompt=PromptTemplate(input_variables=[&#39;page_content&#39;], input_types={}, partial_variables={}, template=&#39;{page_content}&#39;), document_variable_name=&#39;text&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="lcel-equivalent-conceptual">
<h2><a class="toc-backref" href="#id17">LCEL Equivalent (Conceptual)</a><a class="headerlink" href="#lcel-equivalent-conceptual" title="Permalink to this heading">#</a></h2>
<p>LCEL provides:</p>
<ul class="simple">
<li><p>Better composability</p></li>
<li><p>Streaming</p></li>
<li><p>Validation</p></li>
<li><p>Future-proof design</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="when-to-use-stuff-chain">
<h2><a class="toc-backref" href="#id18">When to Use Stuff Chain</a><a class="headerlink" href="#when-to-use-stuff-chain" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Input size is guaranteed small</p></li>
<li><p>Latency matters more than scalability</p></li>
<li><p>Simple QA or summarization</p></li>
<li><p>Learning LangChain basics</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="when-not-to-use-stuff-chain">
<h2><a class="toc-backref" href="#id19">When NOT to Use Stuff Chain</a><a class="headerlink" href="#when-not-to-use-stuff-chain" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Large documents</p></li>
<li><p>Unbounded user input</p></li>
<li><p>Production RAG systems</p></li>
<li><p>Compliance-critical systems</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="best-practices">
<h2><a class="toc-backref" href="#id20">Best Practices</a><a class="headerlink" href="#best-practices" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Limit number of retrieved documents</p></li>
<li><p>Enforce chunk size</p></li>
<li><p>Use low temperature</p></li>
<li><p>Validate token counts</p></li>
<li><p>Add fallbacks for overflow</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="interview-ready-summary">
<h2><a class="toc-backref" href="#id21">Interview-Ready Summary</a><a class="headerlink" href="#interview-ready-summary" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>“A Stuff Chain in LangChain concatenates all input documents into a single prompt and processes them in one LLM call. It is fast and simple but limited by context window size and has largely been superseded by LCEL for production systems.”</p>
</div></blockquote>
</section>
<hr class="docutils" />
<section id="rule-of-thumb">
<h2><a class="toc-backref" href="#id22">Rule of Thumb</a><a class="headerlink" href="#rule-of-thumb" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Few small documents → Stuff</strong></p></li>
<li><p><strong>Many large documents → MapReduce or Refine</strong></p></li>
<li><p><strong>Modern production → LCEL-based RAG</strong></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./langchain\chains"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="06_refine_chain.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Refine Chain</p>
      </div>
    </a>
    <a class="right-next"
       href="08_transform_chain.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">TransformChain (LangChain)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-stuff-chain-exists">Why Stuff Chain Exists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conceptual-flow">Conceptual Flow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-stuff-chain-works-internally">How Stuff Chain Works Internally</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-stuff-chain-demonstration">Basic Stuff Chain Demonstration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-define-the-prompt">Step 1: Define the Prompt</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-create-the-stuff-chain">Step 2: Create the Stuff Chain</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-invoke-the-chain">Step 3: Invoke the Chain</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-execution-simplified">Internal Execution (Simplified)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-use-cases">Common Use Cases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-vs-mapreduce">Stuff Chain vs MapReduce</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-vs-refine">Stuff Chain vs Refine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-of-stuff-chain">Limitations of Stuff Chain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-in-rag-pipelines">Stuff Chain in RAG Pipelines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-vs-lcel-modern-approach">Stuff Chain vs LCEL (Modern Approach)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stuff-chain-legacy">Stuff Chain (Legacy)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lcel-equivalent-conceptual">LCEL Equivalent (Conceptual)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-stuff-chain">When to Use Stuff Chain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-not-to-use-stuff-chain">When NOT to Use Stuff Chain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-practices">Best Practices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interview-ready-summary">Interview-Ready Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rule-of-thumb">Rule of Thumb</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By svgoudar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>